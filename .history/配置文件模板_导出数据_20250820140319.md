# ä½¿ç”¨å¯¼å‡ºæ•°æ®çš„é…ç½®æ–‡ä»¶æ¨¡æ¿

## ä½¿ç”¨è¯´æ˜

åªéœ€åœ¨ä»»ä½•ç°æœ‰é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¸¤è¡Œå³å¯ä½¿ç”¨æ‚¨çš„å¯¼å‡ºæ•°æ®ï¼š

```yaml
prep:
  use_exported_data: True                    # å¯ç”¨å¯¼å‡ºæ•°æ®
  exported_data_dir: '/path/to/exported/'   # æ‚¨çš„å¯¼å‡ºæ•°æ®ç›®å½•è·¯å¾„
```

## å®Œæ•´é…ç½®æ–‡ä»¶ç¤ºä¾‹

### 1. ZINCæ•°æ®é›† (åˆ†å­å›å½’)

```yaml
# configs/Mamba/zinc-exported-EX.yaml
out_dir: results
metric_best: mae
metric_agg: argmin
wandb:
  use: False  # æˆ–æ‚¨çš„wandbé…ç½®
dataset:
  format: PyG-ZINC
  name: subset
  task: graph
  task_type: regression
  node_encoder: True
  node_encoder_name: LinearNode  # å¯¼å‡ºæ•°æ®çš„ç‰¹å¾å·²ç»æ˜¯tokenï¼Œç”¨Linearç¼–ç å™¨
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True                    # ğŸ”¥ å…³é”®ï¼šå¯ç”¨å¯¼å‡ºæ•°æ®
  exported_data_dir: '/path/to/your/exported/'  # ğŸ”¥ å…³é”®ï¼šæ‚¨çš„å¯¼å‡ºæ•°æ®ç›®å½•
train:
  mode: custom
  batch_size: 32
  eval_period: 1
model:
  type: GPSModel
  loss_fun: l1
  graph_pooling: mean
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise  # Graph-Mamba
  layers: 4
  n_heads: 4
  dim_hidden: 64
gnn:
  dim_inner: 64
  batchnorm: True
  act: relu
  dropout: 0.0
optim:
  clip_grad_norm: True
  optimizer: adamW
  weight_decay: 0.01
  base_lr: 0.001
  max_epoch: 200
  scheduler: cosine_with_warmup
  num_warmup_epochs: 10
seed: 42
```

### 2. MOLHIVæ•°æ®é›† (åˆ†å­äºŒåˆ†ç±», ROC-AUCè¯„ä¼°)

```yaml
# configs/Mamba/molhiv-exported-EX.yaml
out_dir: results
metric_best: rocauc  # é‡è¦ï¼šä½¿ç”¨ROC-AUCè¯„ä¼°
wandb:
  use: False
dataset:
  format: OGB
  name: ogbg-molhiv
  task: graph
  task_type: classification_binary
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True                    # ğŸ”¥ å…³é”®é…ç½®
  exported_data_dir: '/path/to/your/exported/'  # ğŸ”¥ å…³é”®é…ç½®
train:
  mode: custom
  batch_size: 32
model:
  type: GPSModel
  loss_fun: cross_entropy
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise
  layers: 4
  dim_hidden: 64
gnn:
  dim_inner: 64
optim:
  base_lr: 0.001
  max_epoch: 100
seed: 42
```

### 3. PROTEINSæ•°æ®é›† (TUå›¾åˆ†ç±»)

```yaml
# configs/Mamba/proteins-exported-EX.yaml
out_dir: results
metric_best: accuracy
dataset:
  format: PyG-TUDataset
  name: PROTEINS
  task: graph
  task_type: classification
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True
  exported_data_dir: '/path/to/your/exported/'
train:
  mode: custom
  batch_size: 32
model:
  type: GPSModel
  loss_fun: cross_entropy
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise
  layers: 4
  dim_hidden: 64
gnn:
  dim_inner: 64
optim:
  base_lr: 0.001
  max_epoch: 100
seed: 42
```

### 4. COLORS-3æ•°æ®é›† (11åˆ†ç±»)

```yaml
# configs/Mamba/colors3-exported-EX.yaml
out_dir: results
metric_best: accuracy
dataset:
  format: PyG-TUDataset
  name: colors3
  task: graph
  task_type: classification
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True
  exported_data_dir: '/path/to/your/exported/'
# ... å…¶ä½™é…ç½®ç±»ä¼¼
```

### 5. COIL-DELæ•°æ®é›† (100åˆ†ç±»)

```yaml
# configs/Mamba/coildel-exported-EX.yaml
out_dir: results  
metric_best: accuracy
dataset:
  format: PyG-TUDataset
  name: coildel
  task: graph
  task_type: classification
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True  
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True
  exported_data_dir: '/path/to/your/exported/'
# ... å…¶ä½™é…ç½®ç±»ä¼¼
```

### 6. Peptides-funcæ•°æ®é›† (å¤šæ ‡ç­¾åˆ†ç±»)

```yaml
# configs/Mamba/peptides-func-exported-EX.yaml
out_dir: results
metric_best: ap  # å¤šæ ‡ç­¾åˆ†ç±»ä½¿ç”¨å¹³å‡ç²¾åº¦
dataset:
  format: OGB
  name: peptides-functional
  task: graph
  task_type: classification_multilabel
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True
  exported_data_dir: '/path/to/your/exported/'
train:
  mode: custom
  batch_size: 16  # å¤šæ ‡ç­¾ä»»åŠ¡å¯èƒ½éœ€è¦è¾ƒå°æ‰¹é‡
model:
  type: GPSModel
  loss_fun: cross_entropy  # å¤šæ ‡ç­¾åˆ†ç±»
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise
  layers: 6
  dim_hidden: 96
gnn:
  dim_inner: 96
optim:
  base_lr: 0.001
  max_epoch: 200
seed: 42
```

### 7. Peptides-structæ•°æ®é›† (å¤šç›®æ ‡å›å½’)

```yaml
# configs/Mamba/peptides-struct-exported-EX.yaml
out_dir: results
metric_best: mae  # å¤šç›®æ ‡å›å½’ä½¿ç”¨MAE
dataset:
  format: OGB
  name: peptides-structural
  task: graph
  task_type: regression
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True
  exported_data_dir: '/path/to/your/exported/'
train:
  mode: custom
  batch_size: 16
model:
  type: GPSModel
  loss_fun: l1  # å›å½’ä»»åŠ¡
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise
  layers: 6
  dim_hidden: 96
gnn:
  dim_inner: 96
optim:
  base_lr: 0.001
  max_epoch: 200
seed: 42
```

### 8. QM9æ•°æ®é›† (å¤šå±æ€§å›å½’) - ç‰¹æ®Šæ ¼å¼

```yaml
# configs/Mamba/qm9-exported-EX.yaml
out_dir: results
metric_best: mae
metric_agg: argmin
dataset:
  format: Exported-QM9  # ğŸ”¥ QM9ä½¿ç”¨ç‰¹æ®Šæ ¼å¼æ ‡è¯†
  name: qm9
  task: graph
  task_type: regression
  node_encoder: True
  node_encoder_name: LinearNode
  edge_encoder: True
  edge_encoder_name: LinearEdge
prep:
  use_exported_data: True
  exported_data_dir: '/path/to/your/exported/'
train:
  mode: custom
  batch_size: 32
model:
  type: GPSModel
  loss_fun: l1
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise
  layers: 4
  dim_hidden: 64
gnn:
  dim_inner: 64
optim:
  base_lr: 0.001
  max_epoch: 200
seed: 42
```

## ä¸åŒæ¨¡å‹çš„é…ç½®é€‰é¡¹

### Graph-Mamba (æ¨è)
```yaml
gt:
  layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise          # ä¸»æ¨æ¨¡å‹
  # layer_type: CustomGatedGCN+Mamba_Hybrid_Degree_Noise_Bucket  # å¤§å›¾ç‰ˆæœ¬
```

### GraphGPS (åŸºçº¿å¯¹æ¯”)
```yaml
gt:
  layer_type: CustomGatedGCN+Transformer  # GPSåŸºçº¿
```

### çº¯GCN (åŸºçº¿å¯¹æ¯”)
```yaml
model:
  type: custom_gnn
gnn:
  layer_type: gatedgcnconv  # æˆ– gineconv
```

## è¿è¡Œå‘½ä»¤ç¤ºä¾‹

```bash
# è®¾ç½®å¯¼å‡ºæ•°æ®ç›®å½•è·¯å¾„ï¼ˆæ ¹æ®æ‚¨çš„å®é™…è·¯å¾„ä¿®æ”¹ï¼‰
export EXPORTED_DATA_DIR="/path/to/your/exported"

# ZINC + Graph-Mamba
python main.py --cfg configs/Mamba/zinc-exported-EX.yaml \
    prep.exported_data_dir $EXPORTED_DATA_DIR

# MOLHIV + GraphGPS 
python main.py --cfg configs/GPS/molhiv-exported-GPS.yaml \
    prep.exported_data_dir $EXPORTED_DATA_DIR

# PROTEINS + Graph-Mamba
python main.py --cfg configs/Mamba/proteins-exported-EX.yaml \
    prep.exported_data_dir $EXPORTED_DATA_DIR

# Peptides-func + Graph-Mamba
python main.py --cfg configs/Mamba/peptides-func-exported-EX.yaml \
    prep.exported_data_dir $EXPORTED_DATA_DIR
```

## æ”¯æŒçš„æ•°æ®é›†å®Œæ•´åˆ—è¡¨

æ ¹æ®æ‚¨çš„å¯¼å‡ºæ•°æ®æ–‡æ¡£ï¼Œä»¥ä¸‹æ•°æ®é›†å®Œå…¨æ”¯æŒï¼š

| æ•°æ®é›† | æ–‡ä»¶å | æ ¼å¼é…ç½® | åç§°é…ç½® | ä»»åŠ¡ç±»å‹ |
|--------|--------|----------|----------|----------|
| QM9 | qm9_export.pkl | Exported-QM9 | qm9 | å¤šå±æ€§å›å½’ |
| ZINC | zinc_export.pkl | PyG-ZINC | subset | å•å±æ€§å›å½’ |
| MOLHIV | molhiv_export.pkl | OGB | ogbg-molhiv | äºŒåˆ†ç±» |
| AQSOL | aqsol_export.pkl | PyG-AQSOL | aqsol | å•å±æ€§å›å½’ |
| COLORS-3 | colors3_export.pkl | PyG-TUDataset | colors3 | 11åˆ†ç±» |
| PROTEINS | proteins_export.pkl | PyG-TUDataset | PROTEINS | 2åˆ†ç±» |
| DD | dd_export.pkl | PyG-TUDataset | DD | 2åˆ†ç±» |
| Mutagenicity | mutagenicity_export.pkl | PyG-TUDataset | mutagenicity | 2åˆ†ç±» |
| COIL-DEL | coildel_export.pkl | PyG-TUDataset | coildel | 100åˆ†ç±» |
| DBLP | dblp_export.pkl | PyG-TUDataset | DBLP | 2åˆ†ç±» |
| TWITTER | twitter_export.pkl | PyG-TUDataset | twitter | 2åˆ†ç±» |
| SYNTHETIC | synthetic_export.pkl | PyG-TUDataset | synthetic | 2åˆ†ç±» |
| Peptides-func | peptides_func_export.pkl | OGB | peptides-functional | å¤šæ ‡ç­¾åˆ†ç±» |
| Peptides-struct | peptides_struct_export.pkl | OGB | peptides-structural | å¤šæ ‡ç­¾å›å½’ |

**æ€»è®¡**: 14ä¸ªæ•°æ®é›†ï¼Œ409,668ä¸ªå›¾ï¼Œ100%æ•°æ®ä¸€è‡´æ€§ä¿è¯ã€‚

## æ³¨æ„äº‹é¡¹

1. **è·¯å¾„é…ç½®**: åŠ¡å¿…å°† `exported_data_dir` è®¾ç½®ä¸ºæ‚¨çš„å®é™…å¯¼å‡ºæ•°æ®ç›®å½•
2. **ç¼–ç å™¨é€‰æ‹©**: å¯¼å‡ºæ•°æ®çš„ç‰¹å¾å·²ç»æ˜¯tokenæ ¼å¼ï¼Œå»ºè®®ä½¿ç”¨ `LinearNode` å’Œ `LinearEdge`  
3. **æ‰¹é‡å¤§å°**: å¤§æ•°æ®é›†ï¼ˆå¦‚QM9ã€TWITTERï¼‰å¯èƒ½éœ€è¦è°ƒæ•´æ‰¹é‡å¤§å°
4. **è¯„ä¼°æŒ‡æ ‡**: ä¸åŒä»»åŠ¡ä½¿ç”¨ä¸åŒçš„æœ€ä½³æŒ‡æ ‡ï¼ˆaccuracy, mae, rocauc, apç­‰ï¼‰
5. **æ•°æ®ä¸€è‡´æ€§**: ä½¿ç”¨å¯¼å‡ºæ•°æ®å¯ç¡®ä¿ä¸æ‚¨åŸé¡¹ç›®100%ä¸€è‡´çš„å®éªŒç»“æœ
